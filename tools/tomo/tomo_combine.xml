<tool id="tomo_combine" name="Tomo Combine Reconstructed Stacks" version="1.0.0" python_template_version="3.9">
    <description>Combine reconstructed tomography stacks</description>
    <macros>
        <import>tomo_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code">
        <![CDATA[
            mkdir tomo_combine_plots;
            $__tool_directory__/tomo_combine.py
            --input_file "$input_file"
            --output_file "output.nex"
            --galaxy_flag
            #if str($x_bounds.type_selector) == "enter_range"
                --x_bounds $x_bounds.low $x_bounds.upp
            #end if
            #if str($y_bounds.type_selector) == "enter_range"
                --y_bounds $y_bounds.low $y_bounds.upp
            #end if
            -l '$log'
        ]]>
    </command>
    <inputs>
        <param name="input_file" type="data" format="nex" optional="false" label="Reconstructed tomography data"/>
        <conditional name="x_bounds">
            <param name="type_selector" type="select" label="Choose reconstructed image range in x-direction">
                <option value="full_range" selected="true">Use the full image range</option>
                <option value="enter_range">Manually enter the image range</option>
            </param>
            <when value="full_range"/>
            <when value="enter_range">
                <param name="low" type="integer" value="-1" optional="false" label="Lower image range index in x-direction"/>
                <param name="upp" type="integer" value="-1" optional="false" label="Upper image range index in x-direction"/>
            </when>
        </conditional>
        <conditional name="y_bounds">
            <param name="type_selector" type="select" label="Choose reconstructed image range in y-direction">
                <option value="full_range" selected="true">Use the full image range</option>
                <option value="enter_range">Manually enter the image range</option>
            </param>
            <when value="full_range"/>
            <when value="enter_range">
                <param name="low" type="integer" value="-1" optional="false" label="Lower image range index in y-direction"/>
                <param name="upp" type="integer" value="-1" optional="false" label="Upper image range index in y-direction"/>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <expand macro="common_outputs"/>
        <collection name="tomo_combine_plots" type="list" label="Combine recontructed data images">
            <discover_datasets pattern="__name_and_ext__" directory="tomo_combine_plots"/>
        </collection>
        <data name="output_file" format="nex" label="Reconstructed tomography data" from_work_dir="output.nex"/>
    </outputs>
    <help><![CDATA[
        Combine reconstructed tomography images.
    ]]></help>
    <expand macro="citations"/>
</tool>
